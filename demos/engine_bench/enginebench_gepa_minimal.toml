# Minimal GEPA config for EngineBench
# Requirements: pareto_set_size >= 10, feedback_seeds >= 3
# Minimum total seeds = 13

[prompt_learning]
algorithm = "gepa"
task_app_url = "http://localhost:8020"
task_app_id = "engine_bench"

[prompt_learning.policy]
model = "gpt-5-nano"
provider = "openai"
inference_mode = "synth_hosted"

[prompt_learning.initial_prompt]
id = "enginebench_coding"
name = "EngineBench Coding Task"

[[prompt_learning.initial_prompt.messages]]
role = "system"
pattern = """You are an expert Rust developer implementing Pokemon TCG cards.

Your task: Implement card effects by editing Rust files with stub functions marked with TODO comments.

Key patterns:
- Use `def_id_matches(&card.def_id, "DF", NUMBER)` to identify cards
- Implement attack modifiers in the `attack_override` function
- Use `game.queue_prompt()` for user choices
- Return `AttackOverrides::default()` if card doesn't apply

Output requirements:
1. EDIT files - replace TODO stubs with working code
2. Make code compile (`cargo check`)
3. Make tests pass (`cargo test`)"""
order = 0

[[prompt_learning.initial_prompt.messages]]
role = "user"
pattern = "{task_description}"
order = 1

[prompt_learning.initial_prompt.wildcards]
task_description = "REQUIRED"

[prompt_learning.gepa]
env_name = "engine_bench"
proposer_type = "synth"
proposer_effort = "LOW"
proposer_output_tokens = "FAST"

[prompt_learning.gepa.rollout]
budget = 100
max_concurrent = 4
minibatch_size = 4

[prompt_learning.gepa.evaluation]
# 13 seeds: 10 for pareto + 3 for feedback
seeds = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
validation_seeds = [13, 14, 15]
validation_top_k = 1

[prompt_learning.gepa.mutation]
rate = 0.5

[prompt_learning.gepa.population]
initial_size = 4
num_generations = 2
children_per_generation = 4
crossover_rate = 0.5

[prompt_learning.gepa.archive]
size = 20
pareto_set_size = 10

[prompt_learning.gepa.token]
max_spend_usd = 10.0
counting_model = "gpt-4"
