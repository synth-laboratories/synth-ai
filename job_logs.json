[PATCH] Attempting to apply Crafter deterministic patch...
[PATCH] Patching crafter.Env._balance_object...
[PATCH] crafter.Env._balance_object patched.
[PATCH] Attempting to apply Crafter serialization patch v3...
[PATCH] Adding enhanced save/load methods to crafter.Env...
[PATCH] crafter.Env.save() and load() methods added (v3).
[PATCH] Crafter serialization patch v3 complete.
[PATCH] Attempting to apply simplified Crafter world configuration patch...
[PATCH] Simplified Crafter world configuration patch complete.
[PATCH] Available configs: easy, normal, hard, peaceful
[
  {
    "id": 275511,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 1,
    "type": "rl.job.created",
    "level": "info",
    "message": "RL job created",
    "data": {
      "work": [
        "health_check",
        "evaluate",
        "train"
      ]
    },
    "created_at": "2025-10-30T03:36:17.277323+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275512,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 2,
    "type": "rl.workflow.preflight",
    "level": "info",
    "message": "Preflight Hatchet configuration",
    "data": {
      "base_url": "https://api.hatchet.run",
      "sdk_version": null,
      "api_key_prefix": "eyJhbG",
      "api_key_present": true,
      "http_health_status": null,
      "http_health_snippet": "preflight_http_error: ConnectError: [Errno 8] nodename nor servname provided, or not known"
    },
    "created_at": "2025-10-30T03:36:17.521539+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275513,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 3,
    "type": "rl.workflow.submission.attempt",
    "level": "info",
    "message": "Submitting RL workflow to Hatchet",
    "data": {
      "have_env_key": true,
      "payload_keys": [
        "job_type",
        "environment_id",
        "revision_id",
        "task_url",
        "training_start_url",
        "work",
        "compute",
        "data",
        "metadata",
        "human_in_the_loop",
        "tags"
      ],
      "plan_preview": "{'job_type': 'rl', 'environment_id': None, 'revision_id': None, 'task_url': None, 'training_start_url': None, 'work': ['health_check', 'evaluate', 'train'], 'compute': {'gpu_type': 'H200', 'gpu_count': 2, 'topology': {'reference_placement': 'none'}}, 'data': {'endpoint_base_url': 'https://synth-laboratories--crafter-blogpost-fastapi-app-dev.modal.run', 'config': {'algorithm': {'type': 'online', 'm",
      "endpoint_base_url": "https://api.hatchet.run",
      "training_start_url": "https://synth-laboratories-dev--gspo-training-service-start-dev-run.modal.run"
    },
    "created_at": "2025-10-30T03:36:18.070534+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275514,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": "013fd7c1-ce32-495b-9e94-9e102b484c2e",
    "seq": 4,
    "type": "hatchet.preflight",
    "level": "info",
    "message": "Hatchet connectivity preflight",
    "data": {
      "host": "api.hatchet.run",
      "port": 443,
      "base_url": "https://api.hatchet.run",
      "dns_error": "[Errno 8] nodename nor servname provided, or not known",
      "tcp_error": "[Errno 8] nodename nor servname provided, or not known",
      "tls_error": "[Errno 8] nodename nor servname provided, or not known",
      "http_error": "[Errno 8] nodename nor servname provided, or not known",
      "sdk_version": null
    },
    "created_at": "2025-10-30T03:36:19.912392+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275515,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": "013fd7c1-ce32-495b-9e94-9e102b484c2e",
    "seq": 5,
    "type": "hatchet.submission.attempt",
    "level": "info",
    "message": "Submitting workflow to Hatchet",
    "data": {
      "base_url": "https://api.hatchet.run",
      "workflow": "RLJobWorkflow",
      "sdk_version": null,
      "payload_keys": [
        "job_id",
        "job_type",
        "plan",
        "run_id",
        "synth_api_key"
      ],
      "api_key_prefix": "eyJhbG",
      "api_key_present": true,
      "payload_preview": "{'job_id': 'job_19a3330072a13580f03', 'job_type': 'rl', 'plan': {'job_type': 'rl', 'environment_id': None, 'revision_id': None, 'task_url': None, 'training_start_url': None, 'work': ['health_check', 'evaluate', 'train'], 'compute': {'gpu_type': 'H200', 'gpu_count': 2, 'topology': {'reference_placement': 'none'}}, 'data': {'endpoint_base_url': 'https://synth-laboratories--crafter-blogpost-fastapi-app-dev.modal.run', 'config': {'algorithm': {'type': 'online', 'method': 'policy_gradient', 'variety'",
      "synth_api_key_prefix": "sk_liv",
      "synth_api_key_present": true
    },
    "created_at": "2025-10-30T03:36:20.255407+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275516,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 6,
    "type": "rl.billing.start",
    "level": "info",
    "message": "GPU usage tracking started for RL job",
    "data": {
      "job_type": "reinforcement_learning",
      "started_at": 1761795380
    },
    "created_at": "2025-10-30T03:36:20.597847+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275517,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": "013fd7c1-ce32-495b-9e94-9e102b484c2e",
    "seq": 7,
    "type": "hatchet.submission.result",
    "level": "info",
    "message": "Received response from Hatchet",
    "data": {
      "dir": [
        "construct",
        "copy",
        "dict",
        "from_dict",
        "from_json",
        "from_orm",
        "json",
        "model_computed_fields",
        "model_config",
        "model_construct",
        "model_copy",
        "model_dump",
        "model_dump_json",
        "model_extra",
        "model_fields",
        "model_fields_set",
        "model_json_schema",
        "model_parametrized_name",
        "model_post_init",
        "model_rebuild",
        "model_validate",
        "model_validate_json",
        "model_validate_strings",
        "parse_file",
        "parse_obj",
        "parse_raw",
        "run",
        "schema",
        "schema_json",
        "shape",
        "task_events",
        "tasks",
        "to_dict",
        "to_json",
        "to_str",
        "update_forward_refs",
        "validate",
        "workflow_config"
      ],
      "repr": "V1WorkflowRunDetails(run=V1WorkflowRun(metadata=APIResourceMeta(id='e406252c-6012-4c01-a54f-e4779271a35b', created_at=datetime.datetime(2025, 10, 30, 3, 36, 20, 478194, tzinfo=TzInfo(UTC)), updated_at=datetime.datetime(2025, 10, 30, 3, 36, 20, 478194, tzinfo=TzInfo(UTC))), status=<V1TaskStatus.RUNNING: 'RUNNING'>, started_at=datetime.datetime(2025, 10, 30, 3, 36, 20, 546965, tzinfo=TzInfo(UTC)), f",
      "id_run": "None",
      "id_meta": "None",
      "id_root": "None",
      "run_type": "V1WorkflowRunDetails",
      "has_metadata": false
    },
    "created_at": "2025-10-30T03:36:21.677615+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275518,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": "013fd7c1-ce32-495b-9e94-9e102b484c2e",
    "seq": 8,
    "type": "workflow.queued",
    "level": "info",
    "message": "Workflow queued",
    "data": {
      "workflow": "RLJobWorkflow",
      "hatchet_run_id": "e406252c-6012-4c01-a54f-e4779271a35b"
    },
    "created_at": "2025-10-30T03:36:23.230327+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275519,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": "013fd7c1-ce32-495b-9e94-9e102b484c2e",
    "seq": 9,
    "type": "rl.workflow.modal.provisioning",
    "level": "info",
    "message": "Modal run accepted; provisioning remote resources",
    "data": {
      "workflow": "RLJobWorkflow",
      "hatchet_run_id": "e406252c-6012-4c01-a54f-e4779271a35b"
    },
    "created_at": "2025-10-30T03:36:23.460583+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275520,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 10,
    "type": "sft.billing.start",
    "level": "info",
    "message": "GPU usage tracking started for SFT job",
    "data": {
      "job_type": "fine_tuning_sft",
      "started_at": 1761795383
    },
    "created_at": "2025-10-30T03:36:23.5302+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275521,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 11,
    "type": "snapshot.fetch",
    "level": "info",
    "message": "Fetching job snapshot",
    "data": {},
    "created_at": "2025-10-30T03:36:23.600173+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275522,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 12,
    "type": "rl.config.fetched",
    "level": "info",
    "message": "Job config fetched",
    "data": {
      "has_config": true
    },
    "created_at": "2025-10-30T03:36:23.780667+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275523,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 13,
    "type": "rl.job.created",
    "level": "info",
    "message": "RL job created and queued for execution",
    "data": {
      "compute": {
        "gpu_type": "H200",
        "topology": {
          "reference_placement": "none"
        },
        "gpu_count": 2
      },
      "job_type": "rl",
      "endpoint_base_url": "https://api.hatchet.run"
    },
    "created_at": "2025-10-30T03:36:23.864778+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275524,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 14,
    "type": "trainer.start",
    "level": "info",
    "message": "Starting trainer",
    "data": {
      "start_url": "https://synth-laboratories-dev--gspo-training-service-start-dev-run.modal.run"
    },
    "created_at": "2025-10-30T03:36:24.360814+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275526,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 15,
    "type": "rl.runtime.modal.started",
    "level": "info",
    "message": "Modal container started RL trainer bootstrap",
    "data": {
      "pid": 6,
      "hostname": null,
      "timestamp": 1761795405.5879848
    },
    "created_at": "2025-10-30T03:36:45.622977+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275527,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 16,
    "type": "rl.training.config",
    "level": "info",
    "message": "Resolved RL training parameters",
    "data": {
      "batch_size": 64,
      "group_size": 512,
      "num_epochs": 1,
      "iterations_per_epoch": 20,
      "weight_sync_interval": 1,
      "update_reference_interval": null
    },
    "created_at": "2025-10-30T03:36:45.690259+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275528,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 17,
    "type": "sft.status.persist",
    "level": "info",
    "message": "Set status=running after start accepted",
    "data": {
      "source": "worker",
      "context": "post_start_accept"
    },
    "created_at": "2025-10-30T03:36:45.923587+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275529,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 18,
    "type": "trainer.triggered",
    "level": "info",
    "message": "Trainer triggered",
    "data": {
      "upstream_id": "job_19a3330072a13580f03",
      "upstream_status": "started"
    },
    "created_at": "2025-10-30T03:36:45.997143+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275530,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 19,
    "type": "rl.billing.compute",
    "level": "info",
    "message": "Resolved compute topology for billing",
    "data": {
      "nodes": null,
      "gpu_type": "H200",
      "gpu_count": 2,
      "container_count": 2,
      "topology_present": true
    },
    "created_at": "2025-10-30T03:36:46.081462+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275531,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 20,
    "type": "rl.inference.spawn.preflight",
    "level": "info",
    "message": "About to spawn vLLM process",
    "data": {
      "module_file": "/root/backend/app/routes/clustered_training/core/algorithms/gspo/subproc.py",
      "start_method": "spawn",
      "sys_path_head": [
        "/root/monorepo/backend",
        "/root",
        "/root",
        "/root/backend",
        "/pkg"
      ],
      "target_module": "app.routes.clustered_training.core.algorithms.gspo.subproc",
      "target_qualname": "run_vllm_server_subprocess"
    },
    "created_at": "2025-10-30T03:36:46.096308+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275532,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 21,
    "type": "rl.job.failed",
    "level": "error",
    "message": "Trainer crashed",
    "data": {
      "error": "Tunnel forwarding failed: Tunnel creation failed for port 8000: Port 8000 is already forwarded. Modal version: 1.1.4. Please upgrade Modal to the latest version.",
      "error_type": "RuntimeError"
    },
    "created_at": "2025-10-30T03:36:46.478281+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275533,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 22,
    "type": "workflow.termination.signal",
    "level": "info",
    "message": "Observed terminal event",
    "data": {
      "seq": 21,
      "event": "rl.job.failed"
    },
    "created_at": "2025-10-30T03:36:46.861655+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275534,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 23,
    "type": "workflow.failed",
    "level": "info",
    "message": "Workflow completed with status failed",
    "data": {
      "status": "failed",
      "last_seq": 21
    },
    "created_at": "2025-10-30T03:36:47.049043+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275535,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 24,
    "type": "rl.billing.window",
    "level": "info",
    "message": "Computed billing window source=wallclock wall_seconds=1.79",
    "data": {
      "source": "wallclock",
      "started_at": "2025-10-30T03:36:45.770439+00:00",
      "finished_at": "2025-10-30T03:36:47.565209+00:00",
      "wall_seconds": 1.79477
    },
    "created_at": "2025-10-30T03:36:47.613039+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275536,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 25,
    "type": "rl.billing.recorded",
    "level": "info",
    "message": "Recorded GPU usage cents=0 qty=0.0009970944444444444 gpu_hour",
    "data": {
      "gpu_type": "H200",
      "cost_cents": 0,
      "autumn_unit": "gpu_hour",
      "wall_seconds": 1.79477,
      "autumn_quantity": 0.0009970944444444444,
      "container_count": 2
    },
    "created_at": "2025-10-30T03:36:48.247063+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275537,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 26,
    "type": "rl.billing.summary",
    "level": "info",
    "message": "GPU charge applied cents=0 qty=0.0009970944444444444 gpu_hour",
    "data": {
      "gpu_type": "H200",
      "autumn_unit": "gpu_hour",
      "charge_cents": 0,
      "wall_seconds": 1.79477,
      "autumn_quantity": 0.0009970944444444444,
      "container_count": 2
    },
    "created_at": "2025-10-30T03:36:48.314854+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275538,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 27,
    "type": "rl.runtime.modal.started",
    "level": "info",
    "message": "Modal container started RL trainer bootstrap",
    "data": {
      "pid": 7,
      "hostname": null,
      "timestamp": 1761795433.9274397
    },
    "created_at": "2025-10-30T03:37:13.992181+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  },
  {
    "id": 275539,
    "job_id": "803ae9cc-113e-47fb-b3a6-ce5c2a242a77",
    "run_id": null,
    "seq": 28,
    "type": "rl.training.config",
    "level": "info",
    "message": "Resolved RL training parameters",
    "data": {
      "batch_size": 64,
      "group_size": 512,
      "num_epochs": 1,
      "iterations_per_epoch": 20,
      "weight_sync_interval": 1,
      "update_reference_interval": null
    },
    "created_at": "2025-10-30T03:37:15.281545+00:00",
    "step": null,
    "component": null,
    "schema_version": 1
  }
]
