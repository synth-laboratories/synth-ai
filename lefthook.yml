# Lefthook Git hooks configuration for synth-ai
# See: https://lefthook.dev/configuration/
#
# Installation:
#   brew install lefthook  # macOS
#   # or: go install github.com/evilmartians/lefthook@latest
#   lefthook install
#
# Usage:
#   lefthook run pre-commit  # Run hooks manually
#   lefthook uninstall      # Remove hooks

pre-commit:
  parallel: true
  jobs:
    # Python: Ruff linting with auto-fix (only on staged Python files that exist)
    - name: python-ruff
      tags:
        - python
        - lint
      glob: "**/*.py"
      run: |
        files=""
        for f in {staged_files}; do
          [ -f "$f" ] && files="$files $f"
        done
        if [ -n "$files" ]; then
          uv run ruff check --fix $files
        fi
      stage_fixed: true

    # Python: Ruff format with auto-fix (only on staged Python files that exist)
    - name: python-ruff-format
      tags:
        - python
        - format
      glob: "**/*.py"
      run: |
        files=""
        for f in {staged_files}; do
          [ -f "$f" ] && files="$files $f"
        done
        if [ -n "$files" ]; then
          uv run ruff format $files
        fi
      stage_fixed: true

    # TUI: TypeScript build check
    - name: tui-build
      tags:
        - typescript
        - build
      glob: "synth_ai/tui/app/**/*.ts"
      root: synth_ai/tui/app
      run: bun run build
