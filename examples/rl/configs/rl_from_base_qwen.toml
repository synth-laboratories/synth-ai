[algorithm]
type = "online"
method = "policy_gradient"
variety = "gspo"

[services]
task_url = "https://your-math-task.modal.run"

[model]
base = "Qwen/Qwen3-4B"
trainer_mode = "full"
label = "math-single-step-qwen3-4b"

[policy]
model = "Qwen/Qwen3-4B"
inference_url = "https://your-inference-host"
max_tokens = 128
temperature = 0.0

[data]
split = "train"
seed_start = 0
episodes_per_iteration = 2048
evaluation_split = "validation"
evaluation_episodes = 256

[training]
num_epochs = 1
iterations_per_epoch = 20
max_turns = 1
ops = ["agent", "env"]
batch_size = 128
group_size = 1024
reward_positive = 1.0
reward_negative_no_tool = -1.0
reward_negative_no_answer = -0.5
learning_rate = 5e-6

[compute]
gpu_type = "A10G"
gpu_count = 4

[topology]
type = "single_node_split"
gpus_for_vllm = 2
gpus_for_training = 2
gpus_for_ref = 0
tensor_parallel = 1

[rollout]
env_name = "math"
policy_name = "math-single-step"
max_turns = 1
episodes_per_batch = 256
task_app_origin_rewards_only = true

[evaluation]
instances = 256
every_n_iters = 10
seeds = [0, 1, 2, 3, 4]

[tags]
experiment = "math_single_step"
