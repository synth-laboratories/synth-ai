[PATCH] Attempting to apply Crafter deterministic patch...
[PATCH] Patching crafter.Env._balance_object...
[PATCH] crafter.Env._balance_object patched.
[PATCH] Attempting to apply Crafter serialization patch v3...
[PATCH] Adding enhanced save/load methods to crafter.Env...
[PATCH] crafter.Env.save() and load() methods added (v3).
[PATCH] Crafter serialization patch v3 complete.
[PATCH] Attempting to apply simplified Crafter world configuration patch...
[PATCH] Simplified Crafter world configuration patch complete.
[PATCH] Available configs: easy, normal, hard, peaceful
{
  "id": "1859552f-7ebf-4fb8-a576-a7f7847b52db",
  "job_id": "job_19a332c1135844f24e0",
  "org_id": "e371b0ef-c61e-4372-a7ea-2a254ab22dc5",
  "user_id": "9a95823b-e093-41df-85fd-6af89e211730",
  "training_type": "rl_online",
  "model_id": "peft:Qwen/Qwen3-4B:job_f774218e6c954517",
  "hyperparameters": {},
  "status": "running",
  "error": null,
  "last_seq": 0,
  "training_file_id": null,
  "eval_file_id": null,
  "engine": "hatchet",
  "engine_ref": "dbd9dcb1-1b02-426f-8d7d-d86044e5e405",
  "fine_tuned_model": null,
  "metadata": {
    "rl": true,
    "tags": {
      "source": "train-cli"
    },
    "cancel": {
      "modal": {
        "calls": [
          {
            "error": "Token missing. Could not authenticate client. If you have token credentials, see modal.com/docs/reference/modal.config for setup help. If you are a new user, register an account at modal.com, then run `modal token new`.",
            "status": "hydrate_failed",
            "call_id": "fc-01K8SJRR7F7DVHRSY86DP66DKJ",
            "cancelled": false,
            "terminated": false
          }
        ]
      },
      "status": "failed",
      "hatchet": {
        "error": "RunsClient.get() got an unexpected keyword argument 'run_id'",
        "status": "unknown",
        "cancelled": true,
        "confirmed": false,
        "hatchet_run_id": "dbd9dcb1-1b02-426f-8d7d-d86044e5e405"
      },
      "attempt_id": "9795544e-a33f-472e-b3cc-345b30cd4c6e",
      "updated_at": "2025-10-30T03:45:57.061894+00:00"
    },
    "compute": {
      "gpu_type": "H200",
      "topology": {
        "reference_placement": "none"
      },
      "gpu_count": 2
    },
    "trainer_started": true,
    "backend_base_url": "http://127.0.0.1.nip.io:8000/api",
    "effective_config": {
      "base": {
        "type": "rl",
        "vllm": {
          "max_model_len": 8192,
          "tensor_parallel_size": 1
        },
        "model": {
          "name": "peft:Qwen/Qwen3-4B:job_f774218e6c954517",
          "label": "crafter-rl-blogpost",
          "source": "peft:Qwen/Qwen3-4B:job_f774218e6c954517",
          "trainer_mode": "lora"
        },
        "compute": {
          "gpu_type": "H200",
          "topology": {
            "reference_placement": "none"
          },
          "gpu_count": 2
        },
        "rollout": {
          "env_name": "crafter",
          "max_turns": 10,
          "policy_name": "crafter-react",
          "episodes_per_batch": 64,
          "max_concurrent_rollouts": 8
        },
        "services": {
          "task_url": "https://synth-laboratories--crafter-blogpost-fastapi-app-dev.modal.run"
        },
        "topology": {
          "type": "single_node_split",
          "gpus_for_ref": 0,
          "gpus_for_vllm": 1,
          "tensor_parallel": 1,
          "gpus_for_training": 1,
          "reference_placement": "none"
        },
        "training": {
          "max_turns": 10,
          "batch_size": 64,
          "group_size": 512,
          "num_epochs": 1,
          "weight_sync": {
            "mode": "direct",
            "enable": true,
            "targets": [
              "policy"
            ],
            "interval": 1,
            "weight_sync_interval": 1
          },
          "log_interval": 1,
          "learning_rate": 5e-06,
          "iterations_per_epoch": 20,
          "weight_sync_interval": 1
        },
        "algorithm": {
          "type": "online",
          "method": "policy_gradient",
          "variety": "gspo"
        },
        "reference": {
          "placement": "none"
        },
        "evaluation": {
          "seeds": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33,
            34,
            35,
            36,
            37,
            38,
            39,
            40,
            41,
            42,
            43,
            44,
            45,
            46,
            47,
            48,
            49,
            50,
            51,
            52,
            53,
            54,
            55,
            56,
            57,
            58,
            59,
            60,
            61,
            62,
            63,
            64,
            65,
            66,
            67,
            68,
            69,
            70,
            71,
            72,
            73,
            74,
            75,
            76,
            77,
            78,
            79,
            80,
            81,
            82,
            83,
            84,
            85,
            86,
            87,
            88,
            89,
            90,
            91,
            92,
            93,
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "instances": 100,
          "every_n_iters": 20
        }
      },
      "data": {
        "vllm": {
          "max_model_len": 8192,
          "tensor_parallel_size": 1
        },
        "rollout": {
          "env_name": "crafter",
          "max_turns": 10,
          "policy_name": "crafter-react",
          "episodes_per_batch": 64,
          "max_concurrent_rollouts": 8
        },
        "services": {
          "task_url": "https://synth-laboratories--crafter-blogpost-fastapi-app-dev.modal.run"
        },
        "topology": {
          "type": "single_node_split",
          "gpus_for_ref": 0,
          "gpus_for_vllm": 1,
          "tensor_parallel": 1,
          "gpus_for_training": 1,
          "reference_placement": "none"
        },
        "evaluation": {
          "seeds": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            27,
            28,
            29,
            30,
            31,
            32,
            33,
            34,
            35,
            36,
            37,
            38,
            39,
            40,
            41,
            42,
            43,
            44,
            45,
            46,
            47,
            48,
            49,
            50,
            51,
            52,
            53,
            54,
            55,
            56,
            57,
            58,
            59,
            60,
            61,
            62,
            63,
            64,
            65,
            66,
            67,
            68,
            69,
            70,
            71,
            72,
            73,
            74,
            75,
            76,
            77,
            78,
            79,
            80,
            81,
            82,
            83,
            84,
            85,
            86,
            87,
            88,
            89,
            90,
            91,
            92,
            93,
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "instances": 100,
          "every_n_iters": 20
        }
      },
      "compute": {
        "gpu_type": "H200",
        "topology": {
          "reference_placement": "none"
        },
        "gpu_count": 2
      }
    },
    "endpoint_base_url": "https://synth-laboratories--crafter-blogpost-fastapi-app-dev.modal.run",
    "training_start_url": "https://synth-laboratories-dev--gspo-training-service-start-dev-run.modal.run",
    "task_app_endpoint_id": "96b16a73-339c-4803-b11d-e4ca86383a5e"
  },
  "created_at": "2025-10-30T03:31:56.504734+00:00",
  "started_at": null,
  "finished_at": null,
  "archived": false,
  "cancel_requested": true,
  "has_run": true,
  "run_id": "40fbd558-14f7-431a-a743-108362e0e227",
  "cost_information": {
    "total_cost_cents": 0,
    "total_cost_dollars": 0.0,
    "wall_seconds": 0.0,
    "gpu_type": "H200",
    "gpu_variant": null,
    "container_count": 2,
    "total_gpus": 2,
    "nodes": 1,
    "gpus_per_node": null,
    "tensor_parallel_size": 1,
    "cost_per_hour": null,
    "cost_recorded_at": null
  }
}
