[pytest]
# Skip all v2 tracing tests in favor of v3
addopts = 
    --ignore=private_tests/tracing_v2/
    --ignore=private_tests/test_duckdb_manager.py
    --ignore=private_tests/test_debug_insert_event.py
    --ignore=private_tests/test_duckdb_trace_upload.py
    --ignore=private_tests/upload_traces_to_duckdb.py
    --ignore=private_tests/test_lm_v2_basic.py
    --ignore=public_tests/test_duckdb_race_conditions.py
    --ignore=public_tests/run_race_condition_test.py
    --ignore=public_tests/test_duckdb_manager.py
    --ignore=debug_constraint_reproduction.py
    --ignore=isolate_constraint_error.py
    --ignore=debug_session_flow.py
    --ignore=test_exception_type.py
    --ignore=test_fresh_database_constraint.py
    --ignore=test_database_check.py
    --ignore=debug_constraint_violation.py
    --ignore=test_duplicate_fix.py
    --ignore=synth_ai/environments/examples/crafter_classic/agent_demos/old/
    --ignore=synth_ai/environments/examples/crafter_classic/agent_demos/crafter_openai_ft/old/
    --ignore=synth_ai/environments/examples/crafter_classic/agent_demos/crafter_modal_ft/old/
    --ignore=synth_ai/environments/examples/crafter_custom/test_comparison_demo.py
    --ignore=synth_ai/environments/examples/crafter_custom/test_configs.py
    --ignore=synth_ai/environments/examples/crafter_custom/test_configs_table.py
    --ignore=synth_ai/environments/examples/crafter_custom/test_crafter_agent_openai.py
    --ignore=synth_ai/environments/examples/
    --ignore=synth_ai/v0/
    # Legacy Pokemon Emerald suite depends on mgba/cv2 and has been retired.
    --ignore=examples/task_apps/dev/pokemon_emerald/external/pokeagent-speedrun/tests
    --ignore=tests/task_apps/test_pokemon_emerald_adapter.py
    # Old rubric trace processor relied on removed schema helpers.
    --ignore=tests/integration/test_rubrics_process_trace.py

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Markers for different test categories
markers =
    v3: Tests for tracing v3
    v2: Tests for tracing v2 (deprecated)
    integration: integration tests that may call external services
    prod: tests that target production endpoints (skipped if env missing)
    unit: Unit tests
    fast: Fast running tests (< 5 seconds)
    slow: Slow running tests (>= 5 seconds)
    vision: Tests for vision/multimodal models
    mipro: Tests for MIPRO prompt learning algorithm
    gepa: Tests for GEPA prompt learning algorithm
    pipeline: Tests for multi-stage pipeline task apps
    single_stage: Tests for single-stage task apps
    gpt41mini: Tests using gpt-4.1-mini model
    gemini: Tests using Google Gemini models
